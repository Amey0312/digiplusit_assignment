(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{628:(e,t,n)=>{Promise.resolve().then(n.bind(n,3792))},3792:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var a=n(5155),o=n(2115);let l=[{type:"Computer",color:"bg-cyan-300"},{type:"Router",color:"bg-yellow-200"},{type:"Switch",color:"bg-purple-200"}],r=[{x:100,y:100},{x:300,y:100},{x:200,y:250}],s="http://localhost:4000/api";function c(){let[e,t]=(0,o.useState)([]),[n,c]=(0,o.useState)([]),[i,d]=(0,o.useState)(l[0].type),[u,h]=(0,o.useState)(null),[p,m]=(0,o.useState)(null),[x,b]=(0,o.useState)(null),[f,g]=(0,o.useState)({x:0,y:0}),[y,w]=(0,o.useState)(null),[v,j]=(0,o.useState)(null),[N,k]=(0,o.useState)([]),[S,M]=(0,o.useState)(""),[C,I]=(0,o.useState)(""),P=(0,o.useRef)(null),[E,T]=(0,o.useState)(""),[O,F]=(0,o.useState)(""),[z,_]=(0,o.useState)("");async function D(){let t=e.findIndex(e=>e.name===S),n=e.findIndex(e=>e.name===C);if(-1!==t&&-1!==n&&t!==n)try{await fetch("".concat(s,"/send-packet"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:t,to:n,payload:"Manual from ".concat(S," to ").concat(C)})}),M(""),I("")}catch(e){console.error("Failed to send packet:",e)}}async function A(){try{await fetch("".concat(s,"/simulate-interval"),{method:"POST"});let e=await fetch("".concat(s,"/network")),t=await e.json();T(t.time||"")}catch(e){console.error("Failed to simulate interval:",e)}}return(0,o.useEffect)(()=>{(async()=>{try{await fetch("".concat(s,"/network"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodes:e,connections:n})})}catch(e){console.error("Failed to sync network:",e)}})()},[e,n]),(0,o.useEffect)(()=>(P.current&&clearInterval(P.current),P.current=setInterval(async()=>{try{let e=await fetch("".concat(s,"/packets")),t=((await e.json()).packets||[]).filter(e=>e.path&&e.progress<e.path.length-1);k(t)}catch(e){console.error("Failed to poll packets:",e)}},600),()=>{P.current&&clearInterval(P.current)}),[]),(0,o.useEffect)(()=>{let e=setInterval(async()=>{try{await fetch("".concat(s,"/advance"),{method:"POST"})}catch(e){console.error("Failed to advance packets:",e)}},600);return()=>clearInterval(e)},[]),(0,o.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat(s,"/network")),t=await e.json();T(t.time||"")}catch(e){console.error("Failed to fetch time:",e)}};e();let t=setInterval(e,2e3);return()=>clearInterval(t)},[]),(0,a.jsxs)("div",{className:"relative min-h-screen p-6 rounded-xl shadow-2xl overflow-hidden select-none bg-gradient-to-br from-blue-50 to-cyan-100",onMouseMove:function(n){if(null!==x){let a=[...e];a[x]={...a[x],x:n.clientX-f.x,y:n.clientY-f.y},t(a)}},onMouseUp:function(){b(null)},children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-blue-700 mb-4 drop-shadow-lg",children:"Network Simulator"}),(0,a.jsxs)("div",{className:"mb-5 flex items-center gap-4 flex-wrap",children:[(0,a.jsx)("label",{className:"font-medium text-gray-700",children:"Node Type:"}),(0,a.jsx)("select",{value:i,onChange:e=>d(e.target.value),className:"px-3 py-1.5 rounded-lg border border-blue-200 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300",children:l.map(e=>(0,a.jsx)("option",{value:e.type,children:e.type},e.type))}),(0,a.jsx)("input",{type:"text",placeholder:"Node Name",value:O,onChange:e=>F(e.target.value),className:"px-3 py-1.5 rounded-lg border border-blue-200 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300 w-32"}),(0,a.jsx)("input",{type:"number",min:"1",placeholder:"Capacity",value:z,onChange:e=>_(e.target.value),className:"px-3 py-1.5 rounded-lg border border-blue-200 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300 w-28"}),(0,a.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white rounded-lg px-5 py-2 font-semibold text-lg shadow-md transition",onClick:function(){if(!O.trim())return;let n=r[e.length%r.length];t(e=>[...e,{x:n.x+40*Math.random(),y:n.y+40*Math.random(),type:i,ip:"192.168.".concat(Math.floor(256*Math.random()),".").concat(Math.floor(256*Math.random())),name:O.trim(),capacity:z?parseInt(z):void 0}]),F(""),_("")},children:"Add Node"}),(0,a.jsx)("span",{className:"text-gray-600 text-base",children:"Click a node, then another to connect. Drag nodes to move."}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"font-medium text-gray-700",children:"Send Packet:"}),(0,a.jsxs)("select",{value:S,onChange:e=>M(e.target.value),className:"px-2 py-1 rounded-lg border border-blue-200 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300 w-28",children:[(0,a.jsx)("option",{value:"",children:"From"}),e.map((e,t)=>(0,a.jsx)("option",{value:e.name,children:e.name},t))]}),(0,a.jsx)("span",{className:"mx-1",children:"→"}),(0,a.jsxs)("select",{value:C,onChange:e=>I(e.target.value),className:"px-2 py-1 rounded-lg border border-blue-200 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300 w-28",children:[(0,a.jsx)("option",{value:"",children:"To"}),e.map((e,t)=>(0,a.jsx)("option",{value:e.name,children:e.name},t))]}),(0,a.jsx)("button",{className:"ml-2 px-4 py-2 rounded-lg font-semibold shadow-md transition text-white ".concat(S&&C&&S!==C?"bg-green-600 hover:bg-green-700":"bg-gray-300 cursor-not-allowed"),disabled:!S||!C||S===C,onClick:D,children:"Send Packet"})]}),(0,a.jsx)("button",{className:"ml-4 px-4 py-2 rounded-lg font-semibold shadow-md transition text-white bg-indigo-600 hover:bg-indigo-700",onClick:A,children:"Simulate Interval"}),(0,a.jsxs)("span",{className:"ml-4 text-indigo-700 font-bold text-lg",children:["Time: ",E]})]}),n.map((t,n)=>{let l=e[t.from],r=e[t.to];if(!l||!r)return null;let s=l.x+40,i=l.y+40,d=r.x+40,u=r.y+40,h=Math.hypot(d-s,u-i),p=180*Math.atan2(u-i,d-s)/Math.PI,m=(s+d)/2,x=(i+u)/2;return(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)("div",{className:"absolute rounded-full transition-all duration-200 ".concat(v===n?"bg-red-400 shadow-lg":"bg-slate-300 shadow"),style:{left:s,top:i,width:h,height:6,transform:"rotate(".concat(p,"deg)"),transformOrigin:"0 50%",zIndex:1},onMouseEnter:()=>j(n),onMouseLeave:()=>j(null)}),(0,a.jsx)("button",{onClick:()=>{c(e=>e.filter((e,t)=>t!==n))},className:"absolute w-6 h-6 rounded-full border-2 border-red-400 text-red-500 font-bold text-base bg-white shadow transition-all duration-200 z-30 ".concat(v===n?"block":"hidden"),style:{left:m-12,top:x-12},title:"Delete connection",onMouseEnter:()=>j(n),onMouseLeave:()=>j(null),children:"\xd7"})]},n)}),N.map((t,n)=>{if(!t.path||t.path.length<2||t.progress>=t.path.length-1)return null;let o=t.progress,l=Math.min(o+1,t.path.length-1),r=e[t.path[o]],s=e[t.path[l]];if(!r||!s)return null;let c=r.x+40+(s.x-r.x)*.5,i=r.y+40+(s.y-r.y)*.5;return(0,a.jsx)("div",{className:"absolute w-6 h-6 rounded-full bg-green-400 border-2 border-green-700 flex items-center justify-center text-white font-bold z-40 shadow-lg animate-bounce",style:{left:c-12,top:i-12},title:"Packet: ".concat(t.payload),children:"✉️"},t.id)}),e.map((n,o)=>{var r;return(0,a.jsxs)("div",{onClick:()=>{null!==p&&p!==o?(c(e=>[...e,{from:p,to:o}]),m(null),h(o)):(h(o),m(o))},onMouseDown:t=>{b(o),g({x:t.clientX-e[o].x,y:t.clientY-e[o].y})},onMouseEnter:()=>w(o),onMouseLeave:()=>w(null),className:"absolute w-20 h-20 rounded-xl flex flex-col items-center justify-center font-bold text-lg cursor-pointer z-20 shadow-lg border-2 transition-all duration-200 ".concat(null==(r=l.find(e=>e.type===n.type))?void 0:r.color," ").concat(u===o?"border-blue-600":"border-blue-200"," ").concat(y===o?"ring-4 ring-blue-200":""),style:{left:n.x,top:n.y,userSelect:"none"},children:[(0,a.jsx)("div",{className:"text-gray-800",children:n.name||n.type}),(0,a.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:n.ip}),void 0!==n.capacity&&(0,a.jsxs)("div",{className:"text-xs text-blue-700 mt-1",children:["Cap: ",n.capacity]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),t(e=>e.filter((e,t)=>t!==o)),c(e=>e.filter(e=>e.from!==o&&e.to!==o).map(e=>({from:e.from>o?e.from-1:e.from,to:e.to>o?e.to-1:e.to}))),h(null)},className:"absolute -top-3 -right-3 w-7 h-7 rounded-full border-2 border-red-400 text-red-500 font-bold text-lg bg-white shadow transition-all duration-200 z-30 ".concat(y===o?"block":"hidden"),title:"Delete node",children:"\xd7"})]},o)}),null!==u&&e[u]&&(0,a.jsxs)("div",{className:"fixed top-1/2 right-8 -translate-y-1/2 p-4 border border-blue-200 rounded-xl bg-white w-80 z-50 shadow-xl",children:[(0,a.jsx)("h3",{className:"text-blue-700 font-semibold mb-2 text-lg",children:"Node Details"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Name:"})," ",e[u].name||e[u].type]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Type:"})," ",e[u].type]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"IP Address:"})," ",e[u].ip]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("b",{children:"Capacity:"})," ",void 0!==e[u].capacity?e[u].capacity:"N/A"]})]})]})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=628)),_N_E=e.O()}]);